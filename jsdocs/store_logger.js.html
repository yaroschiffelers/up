<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: store/logger.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: store/logger.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Modified version of the Vuex internal logger plugin.
 * Optimized for CLI logs.
 */
function createLogger({
  collapsed = true,
  filter = (mutation, stateBefore, stateAfter) => true,
  transformer = state => state,
  mutationTransformer = mut => mut,
  logger = console
} = {}) {
  return store => {
    let prevState = deepCopy(store.state)

    store.subscribe((mutation, state) => {
      if (typeof logger === 'undefined') {
        return
      }
      const nextState = deepCopy(state)

      if (filter(mutation, prevState, nextState)) {
        const time = new Date()
        const formattedTime = ` @ ${pad(time.getHours(), 2)}:${pad(
          time.getMinutes(),
          2
        )}:${pad(time.getSeconds(), 2)}.${pad(time.getMilliseconds(), 3)}`
        const formattedMutation = mutationTransformer(mutation)
        const message = `mutation ${mutation.type}${formattedTime}`
        const startMessage = collapsed ? logger.groupCollapsed : logger.group

        // render
        try {
          startMessage.call(logger, message)
        } catch (e) {
          console.log(message)
        }

        logger.log('---------------------')
        logger.log('[UP] - [VUEX] [STATE]')
        logger.log('[PREV STATE]', transformer(prevState))
        logger.log('[MUTATION]', formattedMutation)
        logger.log('[NEXT STATE]', transformer(nextState))
        logger.log('--------------------- \n')

        try {
          logger.groupEnd()
        } catch (e) {
          logger.log('——--- log end ---——')
        }
      }

      prevState = nextState
    })
  }
}

function repeat(str, times) {
  return new Array(times + 1).join(str)
}

function pad(num, maxLength) {
  return repeat('0', maxLength - num.toString().length) + num
}

/**
 * Deep copy the given object considering circular structure.
 * This function caches all nested objects and its copies.
 * If it detects circular structure, use cached copy to avoid infinite loop.
 *
 * @param {*} obj
 * @param {Array&lt;Object>} cache
 * @return {*}
 */
function deepCopy(obj, cache = []) {
  // just return if obj is immutable value
  if (obj === null || typeof obj !== 'object') {
    return obj
  }

  // if obj is hit, it is in circular structure
  const hit = find(cache, c => c.original === obj)
  if (hit) {
    return hit.copy
  }

  const copy = Array.isArray(obj) ? [] : {}
  // put the copy into cache at first
  // because we want to refer it in recursive deepCopy
  cache.push({
    original: obj,
    copy
  })

  Object.keys(obj).forEach(key => {
    copy[key] = deepCopy(obj[key], cache)
  })

  return copy
}

/**
 * Get the first item that pass the test
 * by second argument function
 *
 * @param {Array} list
 * @param {Function} f
 * @return {*}
 */
function find(list, f) {
  return list.filter(f)[0]
}

module.exports = createLogger
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#assertCb">assertCb</a></li><li><a href="global.html#compose">compose</a></li><li><a href="global.html#createLogger">createLogger</a></li><li><a href="global.html#deepCopy">deepCopy</a></li><li><a href="global.html#dirEnsureExists">dirEnsureExists</a></li><li><a href="global.html#filter">filter</a></li><li><a href="global.html#filterJunk">filterJunk</a></li><li><a href="global.html#find">find</a></li><li><a href="global.html#identity">identity</a></li><li><a href="global.html#is">is</a></li><li><a href="global.html#isArray">isArray</a></li><li><a href="global.html#isBoolean">isBoolean</a></li><li><a href="global.html#isNumber">isNumber</a></li><li><a href="global.html#isObject">isObject</a></li><li><a href="global.html#isString">isString</a></li><li><a href="global.html#isVal">isVal</a></li><li><a href="global.html#LOG_LEVELS">LOG_LEVELS</a></li><li><a href="global.html#mapObject">mapObject</a></li><li><a href="global.html#mapObjectKeyValue">mapObjectKeyValue</a></li><li><a href="global.html#match">match</a></li><li><a href="global.html#no">no</a></li><li><a href="global.html#noop">noop</a></li><li><a href="global.html#once">once</a></li><li><a href="global.html#overload">overload</a></li><li><a href="global.html#readDir">readDir</a></li><li><a href="global.html#readDirAndFilter">readDirAndFilter</a></li><li><a href="global.html#reduceRight">reduceRight</a></li><li><a href="global.html#remove">remove</a></li><li><a href="global.html#requireFile">requireFile</a></li><li><a href="global.html#resolveAndRequire">resolveAndRequire</a></li><li><a href="global.html#resolveRoot">resolveRoot</a></li><li><a href="global.html#store">store</a></li><li><a href="global.html#Up">Up</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Mon Dec 10 2018 22:21:12 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
